# CloudBase AI 开发套件常见问题 FAQ

## 入门与基础功能

### 如何免费试用云开发 AI 能力？

**试用方式：**

1. **新人特权**：新用户首月 0 元体验。
   - 方式 1：已有小程序，通过微信开发者工具或者通过微信公众平台（登录小程序账号，使用微信云服务助手小程序开通，不需要下载开发者工具）开通云开发，首月免费（适用于未使用过云开发的用户）。
   - 方式 2：若无小程序，可先开通微搭体验版[链接](https://console.cloud.tencent.com/lowcode)

2. 之后登录[使用入口](https://tcb.cloud.tencent.com/dev?#/ai?tab=home)试用 AI+ 功能。

### 云开发 AI Agent 能做什么?

**核心功能**
- **多种 AI 能力**：可直接调用大模型 API，或自定义 Agent 接入知识库系统。

**全渠道部署**
- **发布渠道**：支持小程序、Web 网页、微信公众号/服务号及微信客服系统。
- **模型支持**：同时兼容 DeepSeek 和混元双模型。

### 小程序如何接入 AI?

请参考《小程序接入云开发 AI 能力指引》：[链接](https://docs.cloudbase.net/ai/miniprogram-using)

如需进一步操作或建议，请查阅该指引文档。

### 有没有已经开发好的云开发 AI 小程序案例?

有。可通过以小程序体验云开发 AI 能力：

支持 DeepSeek 及智能体实时试玩。

### 不写代码如何发布一个 AI Agent？

可以选择一键发布 Agent 为网页或者小程序，或者参考上述文档来发布到公众号。

### 如何快速创建 AI Agent?

> 首先，确保已经开通过云开发环境，免费开通体验流程请参考上文**如何免费试用云开发 AI 能力？**

1. **登录 AI+**: Agent 后登录[使用入口](https://tcb.cloud.tencent.com/dev?#/ai?tab=agent)试用 AI+ 功能。
2. **创建 Agent**： 创建一个 Agent，选择模型（支持 DeepSeek/混元大模型，）填写设定信息，上传个人知识库，点击保存 Agent

### 是否支持快速基于 AI Agent 创建一个小程序/web 网页

支持，且无需编码基础，零代码可以上线。

完成 Agent 创建之后，可以在保存之后的弹窗中，点击创建应用，支持发布为独立的小程序或网站

### 如何在现有小程序中使用？

需要一定的编码基础，可参考参考《小程序接入云开发 AI 能力指引》：[链接](https://docs.cloudbase.net/ai/miniprogram-using)

### 公众号是否支持接入 AI 实现智能客服？

支持，云开发 Agent 可以一键发布到公众号和服务号作为智能客服，复用微信公众号都对话界面提供客服能力。

1. **发布到公众号**：参考 [如何快速创建 AI Agent?](#如何快速创建-ai-agent?) ,保存之后，点击发布到微信平台，选择公众号或者服务号，填写公众号的 appid，授权之后即可发布到公众号
2. **体验对话功能**：在公众号界面进行对话，即可体验

> 限制条件： 对于订阅号或者未认证的服务号，只能在 15 秒内进行被动回复。若消息处理时间超出这一时限，系统便会自动发送"思考中，请回复'继续'"的提示。已经认证的服务号不受此限制。

**其他方式**
- **公众号菜单嵌入智能客服**：创建完 Agent 之后可以一键生成一个应用，发布为 h5 网页，然后把地址嵌入到公众号菜单中

### 视频号是否可以接入 AI 实现智能客服？

支持，可以参考上一步的 1/2 步骤，先创建完 Agent，然后选择发布到微信客服即可，微信客服支持服务视频号的用户。

### 云开发 Agent 是否支持企业微信智能客服?

**支持**。云开发 Agent 可以发布到微信客服系统，可以参考前面流程，先创建完 Agent，，然后选择发布到微信客服即可，底层基于企业微信，能够服务外部微信客户。

### DeepSeek 是否支持联网搜索？

支持，可通过 Agent 可开启联网搜索能力，支持混元大模型和 DeepSeek

### 是否支持用户在对话中上传文档和图片？

支持，过 Agent 可在对话中上传文档和图片，支持混元大模型和 DeepSeek

### 是否支持用户查看历史记录？

支持，可以使用最新的 Agent UI，默认集成了查看历史记录功能

### 是否支持多个会话分组功能？

目前仅开放了单会话功能，即一个终端用户和一个 Agent 之间暂时只有一个会话，创建会话功能即将支持，敬请期待

### 为什么 Agent 回复速度有些慢？

请检查是否使用了 DeepSeek R1 模型， DeepSeek R1 模型思考过程较久，

可以切换到 DeepSeek V3 模型，没有思考过程，回复更快

或者也可以使用混元大模型的 Turbo S 快思考模型

### 是否支持对接其他平台搭建的智能体？

支持通过函数型智能体对接其他平台的智能体，例如元器等平台开发的 Agent，支持通过 Agent UI 及小程序基础库 SDK 来调用

### 是否开放了 API 可以通过其他语言或者平台来调用？

支持，模型接入接口将可以无缝对接 OpenAI SDK 等开源库，Agent 对话相关接口，可通过 HTTP 请求方式被其他平台任意语言来调用

### 是否支持通过服务器方式开发的小程序或者第三方开发的小程序调用？

只要能够开通云开发，都是可以正常在小程序中使用云开发提供的 AI+能力。

已有小程序，通过微信开发者工具开通云开发或者通过微信公众平台-登录小程序-开通云开发，首月免费（适用于未使用过云开发的用户）。

## 开发

### 如何隐藏 Agent UI 的推理思考过程？

DeepSeek R1 等模型思考过程较久，如果希望隐藏思考过程，可以切换到混元大模型，或者切换到 DeepSeek V3 模型，没有思考过程，回复更快。

或者，在 AgentUI 中进行隐藏

**小程序 Agent UI 组件**

找到如下代码进行删除

```xml
<markdownPreview markdown="{{item.reasoning_content||''}}"></markdownPreview>
```

**Agent UI 可视化组件**

找到思考过程，点击**不可见**，即可隐藏思考过程

### Agent 文件上传或解析失败，如何解决？

由于微信小程序基础库安全策略升级，文件上传功能解析流程可能受到影响，请开发者进行 Agent-UI 组件升级：

1. 小程序源码组件，请更新替换至最新版本
2. 微搭低码组件，请新建页面然后重新拖动更新 agent-ui 区块，完成后发布应用

### Agent 是否查看历史对话记录？

可以，在开发平台的 Agent 详情，点击查看历史记录

### 是否支持通过 API 调用大模型？

支持, 可参考[通过 API 调用](https://docs.cloudbase.net/ai/api-key)

### 是否支持通过 API 调用 Agent?

暂时不支持通过 API key 调用，可以用其他登录方式来对接，然后通过[HTTP API](https://docs.cloudbase.net/http-api/ai-bot/send-message)来调用

### Agent 中是否支持插件和工具调用？

支持，可以通过函数型 Agent 进行开发，支持开源 Agent 框架，如 Langchain、Mastra 等，都可以通过函数型 Agent 进行适配，同时支持通过可视化开发，小程序 和 web 以 API 和 JSSDK 来调用 Agent

### Agent 中是否可以对接外部 API 或者外部数据库？

支持，可以通过函数型 Agent 进行开发，通过工具调用，对接外部 API 或者外部数据库，同时支持通过可视化开发，小程序 和 web 以 API 和 JSSDK 来调用 Agent

### Agent 中是否支持可视化工作流？

暂不支持可视化工作流编排，可通过函数型 Agent 进行代码编排实现复杂的 Agent 功能

### 是否支持对接元器/LKE 等其他 Agent 开发工具提供的 Agent？

支持，可以通过函数型 Agent 进行适配，可以无缝对接元器/LKE 等 Agent 开发工具提供的 Agent，同时支持通过可视化开发，小程序 和 web 以 API 和 JSSDK 来调用 Agent

### 函数型 Agent 是否可以对接公众号/服务号/微信客服？

函数型 Agent 暂时不支持对接微信公众号、服务号、微信客服，即将上线，敬请期待

支持通过可视化开发，小程序 和 web 以 API 和 JSSDK 来调用 Agent

### UniApp/Taro 等框架如何使用云开发 AI 能力？

如果使用微信 Donut 多端框架开发应用，可以使用 wx.cloud.extend.AI 接口来调用云开发 AI 能力，和微信小程序中保持一致，具体可参考[多端框架 wx.cloud.extend.AI 接口](https://developers.weixin.qq.com/miniprogram/dev/platform-capabilities/miniapp/new-capability/cloud/cloud.html#_3-5-wx-cloud-extend-AI-%E6%8E%A5%E5%8F%A3)

UniApp/Taro 可以通过分别调用微信基础库和 JSSDK 来实现多端调用，参考[SDK 初始化](https://docs.cloudbase.net/ai/sdk-reference/init)

### 其他语言或者框架如何使用云开发 AI 能力？

可以通过 HTTP API 来调用，参考[HTTP API](https://docs.cloudbase.net/http-api/ai-bot/send-message)

## 发布与部署

### 小程序中使用了 AI 能力，正式上线前如何通过微信审核？

在发布 AI 智能体到小程序时，微信将在代码审核阶段核实小程序运营的内容与所选类目是否相符。AI 问答涉及深度合成技术，需补充【深度合成-AI 问答】服务类目。

目前，个人主体小程序尚未开放深度合成相关服务类目，建议申请企业主体类型小程序。

对于个人客户，考虑到类目限制，建议使用 H5 或公众号（订阅号/服务号均可），或者小程序的客服消息等其他方式实现 AI 智能体的功能。

1. 确认您的小程序通过了**企业**认证

2. 确认您的环境有效期至少为 3 个月，有助于您通过审核

3. 进入云开发平台[AI+首页](https://tcb.cloud.tencent.com/dev#/ai?tab=home)，点击右上角**小程序算法备案**

4. 填写您的小程序 AppID 和小程序主体名称

5. 平台将会为您生成算法备案资料

6. 前往[微信开发者平台](https://mp.weixin.qq.com/)，提交上一步生成的备案资料页的清晰截图

7. 您可以在服务类目中选择**深度合成**>**AI 问答/AI 换脸/AI 绘画**，选择 2.2 深度合成服务《在用证明》 (证明须含【小程序主体】 、【小程序 appid】 、【订单有效期】、【算法备案号】等内容），将截图上传到微信开发者平台，保证图片清晰可见

## 定价与计费

### 云开发 AI 能力定价如何？

免费版和个人版套餐的用户，可以使用大模型对话能力以及Agent的人设、开场白、问题建议、知识库、数据模型和联网搜索等能力。

团队版及以上的用户，在上述功能的基础上，还可以使用高级能力，如MCP、语音功能、文件上传、多会话模式等。

### 100万token的限时活动

云开发限时活动，为每个环境赠送100万token，6个月内有效，截止时间到2025年12月31日。具体细则如下：

1. 在2025年2月14日之前创建的环境，赠送资源包自2025年2月14日生效，到2025年8月14日失效。
2. 在2025年2月14日～2025年12月31日创建的环境，赠送资包自环境创建之日起生效，6个月后失效。

### 赠送token耗尽之后如何收费?

赠送 token 即将用完或者已耗尽，您可以在 AI+ 模块的大模型页面配置混元/deepseek的 API Key，也可以添加自定义模型，平台将不再限制 token 用量。

## 知识库相关

### 知识库支持哪些文件格式？

目前支持 .md, .pdf, .docx, or .pptx 等文件格式

### 知识库的文件大小限制是怎样的？

单个文件最大 100M，md 文件最大支持 10M，一个知识库支持多个文件

### 知识库是否支持对接微信公众号的文章？

暂时不支持

### 知识库是否支持数据库？

已经支持，可以在 Agent 对接数据模型。

表格等结构化的数据可通过数据库来作为知识库来源，同时支持按照终端用户的权限来查询数据，避免越权访问数据。

### 知识库是否支持上传 Excel？

暂时不支持，正在规划中，可以将 Excel 转换为 pdf 或者 docx 格式上传，效果需要尝试下是否满足预期

也可以建一个数据模型，将 Excel 的数据导入使用，在 Agent 支持配置数据模型，通过数据模型来查询数据，同时支持按照终端用户的权限来查询数据，避免越权访问数据。

## 测试与故障排查

### 小程序发布之后，为什么 AI 不回复消息？

**可能原因及解决方法**

1. **Agent UI 参数配置**：检查是否传入正确的 `botId` 或大模型配置。
2. **微搭可视化开发授权认证**：确保小程序使用扫码授权方式，全托管认证方式暂不支持。
3. **小程序 IDE 基础库版本**：选择 3.7.7 及以上版本。
4. **用户微信客户端版本**：需高于 8.0.55，低于此版本建议升级微信。

**进一步操作**
1. 核对以上各项设置，确保配置正确无误。
2. 若问题依旧存在，建议查阅官方文档或联系技术支持获取帮助。

### 如何优化 AI 对话的输出效果？

可能原因及解决方法：

**1. 知识库内容质量问题**

知识库内容的数量和质量是影响 AI 对话输出效果的重要因素，如果知识库内容数量较少、质量较差，可能导致 AI 对话输出效果较差。建议在知识库中添加高质量的内容，如官方文档、常见问题、FAQ 等。

可以通过**向量检索**的方式来检查知识库内容的质量，如果发现质量较差，可以尝试删除或修改这些内容。

参考[知识库 HTTP API](https://docs.cloudbase.net/http-api/knowledge/search)

1. 在云开发控制台获取 API key,参考文档[通过 API 调用](https://docs.cloudbase.net/ai/api-key)
2. 使用知识库的向量检索接口来检索知识库内容，需要传入知识库的 id，以及用户的问题，可以看到知识库中与用户问题最相似的内容，可以看到每个内容的相似度，如果相似度较低，说明该内容质量较差，可以尝试删除或修改这些内容。

**2. 提示词的配置**

Agent 的提示词配置会影响 AI 对话的输出效果，如果提示词配置不当，可能导致 AI 对话输出效果较差。

可以采用提示词工程的一些通用技巧来优化提示词，参考[提示词工程](https://www.promptingguide.ai/zh)

可采用的方法包括：
1. 使用清晰、明确、简洁的提示词来引导 AI 生成答案，避免使用过于复杂或模糊的提示词。
2. 结构化 Prompt 模板（CO-STAR 框架）
3. 针对一些必须要遵循的要求，可以通过增加强调词来引导 AI，例如加入**特别重要**等字眼来要求 AI 遵循要求。
4. 为 AI 提供输出的样例，例如在提示词中加入**示例：**等字眼，引导 AI 生成符合要求的答案。
5. 对于许多复杂任务，，可以设置步骤，例如"第一步：xxx，第二步：xxx，第三步：xxx"等。
6. 引导模型思考，例如在提示词中加入**请思考**等字眼，引导 AI 思考后再生成答案。
7. 提示词的迭代，针对现网回答的效果进行评估和迭代提示词。

### 流式输出过程突然中断的原因是什么？

如果 Agent 出现了思考或者回答中途会停止的问题，目前主要出现在当思考内容较长或者回答内容较长的情况，在请求大模型时，提示词的简单程度、网络速度等多重因素可能都会让请求时长增加。

可能原因：**客户端请求超时**，可以修改客户端网络超时配置

**小程序端全局超时配置**

可以在微信小程序中的 app.json 中配置全局超时时间，可以根据小程序的实际情况进行配置，建议配置为 10 分钟以内

```json
{
  "networkTimeout": {
    "request": 600000
  }
}
```

参考链接：https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html#networkTimeout

**web 端超时配置**

cloudbase-js-sdk 默认设置了超时时间为 15 秒，当请求超时时，会主动取消请求。用户可以在 `cloudbase.init` 时自定义超时时间。

```javascript
import cloudbase from "@cloudbase/js-sdk";

const app = cloudbase.init({
  env: "your-env", // 需替换为实际使用环境 id
  timeout: 600000, // 设置超时时间为 10 分钟
});

const auth = app.auth();
await auth.signInAnonymously(); // 或者使用其他登录方式

const ai = app.ai(); // 后续就可以按常规方式调用 ai 能力了
```

## 技术细节

### 在小程序中使用 AI+，我该用微信小程序基础库还是 AI SDK？

AI SDK 和微信小程序基础库提供的 AI 能力是相同的。

AI SDK 是云开发提供的多端 SDK，在多个平台都有一致的使用体验。如果您有一码多端的需求，可以选用 AI SDK。

然而在小程序上使用 AI SDK 会受到一定的限制：
1. 小程序包体积有限制，引入 AI SDK 会增加一定的包体积
2. 小程序需要配置服务器域名，配置完成后 AI SDK 才能进行请求

微信小程序基础库内置了完整的云开发 AI 能力，不占用包体积，也无需配置服务器域名。对于专注于小程序的开发者们，使用微信小程序基础库是一个好的选择。在不用安装任何外部包的情况下，也能完整地访问到云开发提供的 AI+ 能力。

微信小程序基础库和 AI SDK 在使用方法上有一定的区分，请注意阅读文档。 